\begin {document}

\title {\ZHH \huge 学习ejoy2d——sprite}
\author {\small gaccob}
\date {\small 2014 年 3 月 12 日}
\maketitle

\section {\ZHH sprite} {

    { sprite是ejoy2d中最复杂的数据结构, "每个 sprite 都是若干图元以树状组合起来的".}\par

\begin{lstlisting}[language=C]
struct sprite {
    struct sprite * parent;
    uint16_t type;

    // `\color{gray} 唯一id, 因为是数组, 所以不建议散的太开`
    uint16_t id;

    struct sprite_trans t;

    // `\color{gray} 5种基本图元`
    union {
        struct pack_animation *ani;
        struct pack_picture *pic;
        struct pack_polygon *poly;
        struct pack_label *label;
        struct pack_pannel *pannel;
        struct matrix *mat;
    } s;

    // 渲染时的附加矩阵
    struct matrix mat;

    int start_frame;
    int total_frame;
    int frame;
    bool visible;
    bool message;
    const char *name;	// name for parent
    union {
        struct sprite * children[1];
        const char * text;
        int scissor;
    } data;
};
\end{lstlisting}

}

\end{document}

